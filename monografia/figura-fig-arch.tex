\begin{figure}[htb]
\centering
%\begin{psmatrix}[mnode=r,colsep=0.1,rowsep=0.3]
$\psmatrix[mnode=r,colsep=0.1,rowsep=0.3]
&[name=a1]\footnotesize{<A_1,o_1>} && [name=c1] \footnotesize{<A_2,o_2>} &\ldots& [name=e1] \footnotesize{<A_{t-1},o_{t-1}>} && [name=g1] \footnotesize{<A_t,o_t>}\\[0pt]
& & & & & & &\\[0pt]
&[name=a2] \myx{\mbox{~\footnotesize{CNN}~}} & & [name=c2] \myx{\mbox{~\footnotesize{CNN}~}} & \ldots & [name=e2] \myx{\mbox{~\footnotesize{CNN}~}}& & [name=g2] \myx{\mbox{~\footnotesize{CNN}~}}\\[0pt]
& & & & & & &\\[0pt]
&[name=a3] \mybox{\mbox{\footnotesize{LSTM}}} & & [name=c3] \mybox{\mbox{\footnotesize{LSTM}}} & [name=x] \ldots & [name=e3] \mybox{\mbox{\footnotesize{LSTM}}}& & [name=g3] \mybox{\mbox{\footnotesize{LSTM}}}\\[0pt]
& & & & & & &\\[0pt]
& [name=a4] & & [name=c4] & & [name=e4] & & [name=g4]\\[0pt]
 && [name=a] && && [name=b]
\endpsmatrix $
\psset{nodesep=3pt,arrows=->}

\ncline{->}{a}{b}
\ncput*{\footnotesize{dynamic predictions}}
\ncline{->}{a1}{a2}
\ncline{->}{a2}{a3}
\ncline{->}{a3}{a4}
\ncput*{\footnotesize{Dense}}
\ncline{->}{c1}{c2}
\ncline{->}{c2}{c3}
\ncline{->}{c3}{c4}
\ncput*{\footnotesize{Dense}}
\ncline{->}{e1}{e2}
\ncline{->}{e2}{e3}
\ncline{->}{e3}{e4}
\ncput*{\footnotesize{Dense}}
\ncline{->}{g1}{g2}
\ncline{->}{g2}{g3}
\ncline{->}{g3}{g4}
\ncput*{\footnotesize{Dense}}
\nccurve[angleA=45,angleB=90]{a3}{c3}
\nccurve[angleA=45,angleB=90,linestyle=dashed]{c3}{e3}
\nccurve[angleA=45,angleB=90]{e3}{g3}
%\end{psmatrix}
\caption{Network architecture for predicting patient outcomes over time. Each convolutional (CNN) layer is followed by a LSTM layer and different feature transference approaches are designed using this architecture.}
\label{fig:arch}
\end{figure}

